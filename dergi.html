<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TEKİR — Dergiyi Oku</title>
  <link rel="icon" href="assets/img/favicon.png" />
  <link rel="stylesheet" href="assets/css/style.css" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <!-- PDF.js CDN -->
<script src="assets/vendor/pdfjs/pdf.min.js"></script> 
</head>
<body class="viewer-body">
  <div class="bg-orb orb-a"></div>
  <div class="bg-orb orb-b"></div>
  <div class="noise"></div>

  <header class="header">
    <div class="container header-inner">
      <a class="brand" href="index.html">
        <img class="brand-logo" src="assets/img/logo.png" alt="Logo">
        <div class="brand-text">
          <div class="brand-title">TEKİR</div>
          <div class="brand-sub">Dergiyi Oku</div>
        </div>
      </a>

      <nav class="nav">
        <a href="index.html#sayilar">Sayılar</a>
        <a href="hakkinda.html">Hakkında</a>
        <a href="kulup.html">Kulüp</a>
        <a class="btn btn-ghost" href="assets/pdf/tekir-sayi-1.pdf" target="_blank" rel="noopener">PDF</a>
      </nav>

      <button class="nav-toggle" aria-label="Menüyü aç" data-nav-toggle>
        <span></span><span></span><span></span>
      </button>
    </div>

    <div class="mobile-nav" data-mobile-nav>
      <a href="index.html#sayilar">Sayılar</a>
      <a href="hakkinda.html">Hakkında</a>
      <a href="kulup.html">Kulüp</a>
      <a href="assets/pdf/tekir-sayi-1.pdf" target="_blank" rel="noopener">PDF</a>
    </div>
  </header>

  <main class="viewer">
    <div class="container">
      <div class="viewer-top">
        <div class="viewer-title">
          <h1>TEKİR • Sayı 1</h1>
          <p class="muted">Ekim — Kasım • 2025–2026</p>
        </div>

        <div class="viewer-controls">
<a id="dlTop" class="btn btn-primary" href="assets/pdf/tekir-sayi-1.pdf" download>İndir</a>
<button class="btn btn-ghost" id="fsBtn" title="Tam ekran">⛶</button>

          <div class="ctrl">
            <span class="muted small">Sayfa</span>
            <input id="pageInput" type="number" min="1" value="1" />
            <span class="muted small" id="pageCount">/ ?</span>
            <button class="btn btn-soft" id="goBtn">Git</button>
          </div>

          <div class="ctrl">
            <button class="btn btn-ghost" id="zoomOut">−</button>
            <button class="btn btn-ghost" id="zoomIn">+</button>
          </div>

          <a class="btn btn-primary" href="assets/pdf/tekir-sayi-1.pdf" download>İndir</a>
        </div>
      </div>

      <div class="viewer-search">
        <input id="searchInput" placeholder="Dergide ara (ör: Atatürk, Cumhuriyet, LÖSEV…)" />
        <button class="btn btn-soft" id="searchBtn">Ara</button>
        <div class="muted small" id="searchResult"></div>
      </div>

      <div class="viewer-stage">
<div class="canvas-wrap">
  <button class="fs-nav fs-left" id="fsPrev" aria-label="Önceki sayfa">‹</button>
  <button class="fs-nav fs-right" id="fsNext" aria-label="Sonraki sayfa">›</button>

  <canvas id="pdfCanvas"></canvas>
</div>

        <aside class="thumbs">
          <div class="thumbs-head">
            <div class="muted small">Hızlı Geçiş</div>
          </div>
          <div id="thumbList" class="thumb-list"></div>
        </aside>
      </div>
    </div>
  </main>

  <script src="assets/js/app.js"></script>
<script src="assets/js/viewer.js?v=FINAL9"></script>
</body>
</html>
<script>
// 1. magazine div'sini ekle veya var mı kontrol et
(function() {
  // canvas-wrap içerisine magazine ekle
  var canvasWrap = document.querySelector('.canvas-wrap');
  if (!canvasWrap) return;
  
  // canvas ve nav oklarını sakla
  var pdfCanvas = document.getElementById('pdfCanvas');
  var fsPrev = document.getElementById('fsPrev');
  var fsNext = document.getElementById('fsNext');
  if (pdfCanvas) pdfCanvas.style.display = 'none';
  if (fsPrev) fsPrev.style.display = 'none';
  if (fsNext) fsNext.style.display = 'none';

  // Benzeri varsa kaldır
  var prevMagazine = document.getElementById('magazine');
  if (prevMagazine) prevMagazine.remove();

  // Magazine ana sayfa container divi
  var magazineDiv = document.createElement('div');
  magazineDiv.id = "magazine";
  magazineDiv.style.width = "760px";
  magazineDiv.style.height = "1032px";
  magazineDiv.style.margin = "0 auto";
  magazineDiv.style.boxShadow = "0 2px 16px rgba(0,0,0,.22)";

  // 34 sayfa için img ekle
  for (let i = 1; i <= 34; i++) {
    let page = document.createElement('div');
    page.className = "page";
    page.style.background = "#fff";
    page.style.width = "380px";
    page.style.height = "1032px";
    page.style.overflow = "hidden";
    page.style.display = "flex";
    page.style.alignItems = "center";
    page.style.justifyContent = "center";
    let img = document.createElement('img');
    img.src = "assets/img/sayfa" + i + ".png";
    img.alt = "Dergi Sayfa " + i;
    img.style.maxWidth = "100%";
    img.style.maxHeight = "100%";
    img.style.width = "100%";
    img.style.height = "auto";
    page.appendChild(img);
    magazineDiv.appendChild(page);
  }

  canvasWrap.appendChild(magazineDiv);

  // 2. turn.js yüklemesi ve başlat
  function loadScript(url, cb){
    var s = document.createElement('script');
    s.src = url;
    s.onload = cb;
    document.body.appendChild(s);
  }

  function initTurn() {
    // dergi sayfaları oranı: 380x1032 px = 760x1032 spread (2 sayfa)
    // Responsive için:
    function resizeMagazine() {
      var maxWidth = canvasWrap.offsetWidth || 760;
      var maxHeight = window.innerHeight - 120;
      var ratio = 760/1032;
      var ww = Math.min(maxWidth, 760);
      var hh = Math.floor(ww / ratio);
      if(hh > maxHeight) {
        hh = maxHeight;
        ww = Math.floor(hh * ratio);
      }
      magazineDiv.style.width = ww + "px";
      magazineDiv.style.height = hh + "px";
      if(window.$ && $(magazineDiv).data('turn')) {
        $(magazineDiv).turn('size', ww, hh);
      }
    }

    // Turn.js-4
    $(magazineDiv).turn({
      width: magazineDiv.offsetWidth,
      height: magazineDiv.offsetHeight,
      elevation: 40,
      gradients: true,
      autoCenter: true
    });

    window.addEventListener('resize', resizeMagazine);
    setTimeout(resizeMagazine, 500);
  }

  // Eğer turn.js veya jQuery yoksa ekle
  function ensureJqueryAndTurn(cb) {
    if (window.jQuery && window.jQuery.fn && window.jQuery.fn.turn) {
      cb();
      return;
    }
    function ensureTurn() {
      if (window.jQuery && window.jQuery.fn.turn) cb();
      else loadScript('assets/vendor/turn/turn.min.js', cb);
    }
    if (!window.jQuery) {
      loadScript('https://code.jquery.com/jquery-3.6.0.min.js', ensureTurn);
    } else {
      ensureTurn();
    }
  }

  ensureJqueryAndTurn(initTurn);

  // 3. PDF.js kodlarını pasifleştir
  // canvas, thumb ve search ile ilgili işleri devre dışı bırak
  var style = document.createElement('style');
  style.innerHTML = `
    #pdfCanvas, .thumbs, .viewer-search, .viewer-controls .ctrl, #zoomOut, #zoomIn, #pageInput, #pageCount, #goBtn {
      display: none !important;
    }
    .viewer-controls > a.btn-primary { display: none !important; }
  `;
  document.head.appendChild(style);

  // PDF.js eventlerini yok et
  if (window.pdfDoc) window.pdfDoc = null;
  if (window.renderPage) window.renderPage = function(){};
  if (window.fitToScreen) window.fitToScreen = function(){};

})();
</script>
